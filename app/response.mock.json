{"responseHeader":{"status":0,"QTime":0,"params":{"q":"*:*","fq":["parent_bug:bug_netbeans_189621","type:(CHANGESET OR HUNKS)"],"sort":"type asc","wt":"json"}},"response":{"numFound":35,"start":0,"docs":[{"id":"176068:5422427852ea","type":"CHANGESET","parentSHA1":"176062:7002adc9cfe4","user":"Jaroslav Bachorik <yardus@netbeans.org>","date_string":"Wed Aug 18 10:35:02 2010 +0200","summary":"#189621: Enable collecting thread cpu timestamps by default","file_c":["lib.profiler.common/src/org/netbeans/lib/profiler/common/integration/IntegrationUtils.java","lib.profiler/release/remote-pack-defs/README.txt","lib.profiler/release/remote-pack-defs/build.xml","lib.profiler/release/remote-pack-defs/calibrate-16.sh","lib.profiler/release/remote-pack-defs/profile-linux-16.sh","lib.profiler/src/org/netbeans/lib/profiler/TargetAppRunner.java","lib.profiler/src/org/netbeans/lib/profiler/global/CalibrationDataFileIO.java","lib.profiler/src/org/netbeans/lib/profiler/results/cpu/TimingAdjusterOld.java","profiler.attach/src/org/netbeans/modules/profiler/attach/providers/AbstractIntegrationProvider.java","profiler.j2se/src/org/netbeans/modules/profiler/j2se/JavaApplicationIntegrationProvider.java","profiler/src/org/netbeans/modules/profiler/NetBeansProfiler.java","profiler/src/org/netbeans/modules/profiler/actions/AntActions.java","profiler/src/org/netbeans/modules/profiler/ui/stp/Bundle.properties","profiler/src/org/netbeans/modules/profiler/ui/stp/DefaultSettingsConfigurator.java"],"number_files":14,"insertions":113,"deletions":34,"churns":147,"parent_bug":"bug_netbeans_189621"},{"parent_bug":"bug_netbeans_189621","parent_changeset":"176068:5422427852ea","type":"HUNKS","id":"176068:5422427852ea@@ -131,6 +131,13 @@lib.profiler.common/src/org/netbeans/lib/profiler/common/integration/IntegrationUtils.java","negative_churns":0,"positive_churns":7,"insertion":"@@ -131,6 +131,13 @@","change":["     }"," ","     // Returns batch file extension bat / sh according to current / selected OS","+    public static String getBatchExtensionString(String targetPlatform, String customExt) {","+        if (isWindowsPlatform(targetPlatform)) {","+            return customExt + \".bat\"; //NOI18N","+        }","+        return customExt + \".sh\"; //NOI18N","+    }","+","     public static String getBatchExtensionString(String targetPlatform) {","         if (isWindowsPlatform(targetPlatform)) {","             return \".bat\"; //NOI18N"]},{"parent_bug":"bug_netbeans_189621","parent_changeset":"176068:5422427852ea","type":"HUNKS","id":"176068:5422427852ea@@ -355,7 +362,7 @@lib.profiler.common/src/org/netbeans/lib/profiler/common/integration/IntegrationUtils.java","negative_churns":1,"positive_churns":1,"insertion":"@@ -355,7 +362,7 @@","change":["     }"," ","     public static String getManualRemoteStep2(String targetOS, String targetJVM) {","-        return MessageFormat.format(MANUAL_REMOTE_STEP2_MESSAGE, new Object[] { getRemoteCalibrateCommandString(targetOS) }); //NOI18N","+        return MessageFormat.format(MANUAL_REMOTE_STEP2_MESSAGE, new Object[] { getRemoteCalibrateCommandString(targetOS, targetJVM) }); //NOI18N","     }"," ","     // Returns getLibsDir()/deployed/jdk&lt;15&gt;/&lt;OS&gt; appropriate for current / selected OS"]},{"parent_bug":"bug_netbeans_189621","parent_changeset":"176068:5422427852ea","type":"HUNKS","id":"176068:5422427852ea@@ -442,9 +449,14 @@lib.profiler.common/src/org/netbeans/lib/profiler/common/integration/IntegrationUtils.java","negative_churns":3,"positive_churns":8,"insertion":"@@ -442,9 +449,14 @@","change":["     // Returns extra command line arguments without additional quotes required when attaching on startup","     public static String getProfilerAgentCommandLineArgsWithoutQuotes(String targetPlatform, String targetJVM, boolean isRemote,","                                                                       int portNumber) {","-        return \"-agentpath:\" + getNativeLibrariesPath(targetPlatform, targetJVM, isRemote)","-               + getDirectorySeparator(targetPlatform) + getProfilerAgentLibraryFile(targetPlatform) + \"=\" //NOI18N","-               + getLibsDir(targetPlatform, isRemote) + \",\" + portNumber; //NOI18N","+        StringBuilder args = new StringBuilder();","+        if (targetJVM.equals(PLATFORM_JAVA_60) &amp;&amp; (targetPlatform.equals(PLATFORM_LINUX_OS) || targetPlatform.equals(PLATFORM_LINUX_AMD64_OS))) {","+            args.append(\" -XX:+UseLinuxPosixThreadCPUClocks \"); // NOI18N","+        }","+        args.append(\"-agentpath:\").append(getNativeLibrariesPath(targetPlatform, targetJVM, isRemote)). // NOI18N","+               append(getDirectorySeparator(targetPlatform)).append(getProfilerAgentLibraryFile(targetPlatform)).append(\"=\"). //NOI18N","+               append(getLibsDir(targetPlatform, isRemote)).append(\",\").append(portNumber); //NOI18N","+        return args.toString();","     }"," ","     // Returns filename of profiler agent library"]},{"parent_bug":"bug_netbeans_189621","parent_changeset":"176068:5422427852ea","type":"HUNKS","id":"176068:5422427852ea@@ -463,7 +475,7 @@lib.profiler.common/src/org/netbeans/lib/profiler/common/integration/IntegrationUtils.java","negative_churns":1,"positive_churns":1,"insertion":"@@ -463,7 +475,7 @@","change":["     }"," ","     public static String getProfilerModifiedReplaceFileHeader(String targetPlatform) {","-        return getProfilerModifiedFileHeader(targetPlatform) + getSilentScriptCommentSign(targetPlatform) + \" \"","+        return getProfilerModifiedFileHeader(targetPlatform) + getSilentScriptCommentSign(targetPlatform) + \" \" // NOI18N","                + ORIGINAL_BACKUP_LOCATION_STRING + getLineBreak(targetPlatform); //NOI18N","     }"," "]},{"parent_bug":"bug_netbeans_189621","parent_changeset":"176068:5422427852ea","type":"HUNKS","id":"176068:5422427852ea@@ -472,15 +484,17 @@lib.profiler.common/src/org/netbeans/lib/profiler/common/integration/IntegrationUtils.java","negative_churns":6,"positive_churns":8,"insertion":"@@ -472,15 +484,17 @@","change":["     }"," ","     // Returns calibration batch filename","-    public static String getRemoteCalibrateCommandString(String targetPlatform) {","-        return HTML_REMOTE_STRING + getDirectorySeparator(targetPlatform) + \"bin\" + getDirectorySeparator(targetPlatform)","-               + \"calibrate\" + getBatchExtensionString(targetPlatform); //NOI18N","+    public static String getRemoteCalibrateCommandString(String targetPlatform, String targetJava) {","+        String customExt = isLinuxPlatform(targetPlatform) ? (PLATFORM_JAVA_60.equals(targetJava) ? \"-16\" : \"-15\") : \"\"; // NOI18N","+        return HTML_REMOTE_STRING + getDirectorySeparator(targetPlatform) + \"bin\" + getDirectorySeparator(targetPlatform) // NOI18N","+               + \"calibrate\" + getBatchExtensionString(targetPlatform,  customExt); //NOI18N","     }"," ","     // Returns profile batch filename","-    public static String getRemoteProfileCommandString(String targetPlatform) {","-        return HTML_REMOTE_STRING + getDirectorySeparator(targetPlatform) + \"bin\" + getDirectorySeparator(targetPlatform)","-               + \"profile\" + getBatchExtensionString(targetPlatform); //NOI18N","+    public static String getRemoteProfileCommandString(String targetPlatform, String targetJava) {","+        String customExt = PLATFORM_JAVA_50.equals(targetJava) ? \"-15\" : \"-16\"; // NOI18N","+        return HTML_REMOTE_STRING + getDirectorySeparator(targetPlatform) + \"bin\" + getDirectorySeparator(targetPlatform) // NOI18N","+               + \"profile\" + getBatchExtensionString(targetPlatform, customExt); //NOI18N","     }"," ","     // returns \"rem\" or \"#\" according to provided platform"]},{"parent_bug":"bug_netbeans_189621","parent_changeset":"176068:5422427852ea","type":"HUNKS","id":"176068:5422427852ea@@ -509,6 +523,10 @@lib.profiler.common/src/org/netbeans/lib/profiler/common/integration/IntegrationUtils.java","negative_churns":0,"positive_churns":4,"insertion":"@@ -509,6 +523,10 @@","change":["         return targetPlatform.equals(PLATFORM_WINDOWS_OS) || targetPlatform.equals(PLATFORM_WINDOWS_AMD64_OS);","     }"," ","+    public static boolean isLinuxPlatform(String targetPlatform) {","+        return targetPlatform.equals(PLATFORM_LINUX_OS) || targetPlatform.equals(PLATFORM_LINUX_AMD64_OS);","+    }","+","     public static String getXMLCommendEndSign() {","         return \"--&gt;\"; //NOI18N","     }"]},{"parent_bug":"bug_netbeans_189621","parent_changeset":"176068:5422427852ea","type":"HUNKS","id":"176068:5422427852ea@@ -1,7 +1,7 @@lib.profiler/release/remote-pack-defs/README.txt","negative_churns":1,"positive_churns":1,"insertion":"@@ -1,7 +1,7 @@","change":[" NetBeans Profiler Server Pack 6.5 README"," "," This server pack allows you to do remote profiling. First you need to","-run the calibrate.bat/calibrate.sh script located in the bin directory.","+run the calibrate.bat/calibrate.sh/calibrate-(5|6).sh script located in the bin directory."," You can use profile.sh or profile.bat script located in the bin directory"," instead of java command to run your application in profiling mode. "," Check the script for any additional modifications according to your "]},{"parent_bug":"bug_netbeans_189621","parent_changeset":"176068:5422427852ea","type":"HUNKS","id":"176068:5422427852ea@@ -215,7 +215,10 @@lib.profiler/release/remote-pack-defs/build.xml","negative_churns":1,"positive_churns":4,"insertion":"@@ -215,7 +215,10 @@","change":["     &lt;/antcall&gt;","  &lt;/target&gt;"," ","-  &lt;target name=\"profiler-server-common-unix\" depends=\"profiler-server-common\"&gt;","+  &lt;target name=\"profiler-server-calibration-linux\" if=\"isLinux\"&gt;","+      &lt;copy tofile=\"${build.dir}/bin/calibrate-${jdk-version}.sh\" file=\"calibrate-${jdk-version}.sh\" /&gt;","+  &lt;/target&gt;","+  &lt;target name=\"profiler-server-common-unix\" depends=\"profiler-server-common\" unless=\"isLinux\"&gt;","      &lt;copy tofile=\"${build.dir}/bin/calibrate.sh\" file=\"calibrate${calibrate-suffix}.sh\" /&gt;","   &lt;/target&gt;"," "]},{"parent_bug":"bug_netbeans_189621","parent_changeset":"176068:5422427852ea","type":"HUNKS","id":"176068:5422427852ea@@ -231,6 +234,13 @@lib.profiler/release/remote-pack-defs/build.xml","negative_churns":0,"positive_churns":7,"insertion":"@@ -231,6 +234,13 @@","change":["   &lt;/target&gt;"," ","   &lt;target name=\"profiler-server-jdkspecific-unix\" depends=\"profiler-server-jdkspecific\"&gt;","+    &lt;condition property=\"isLinux\"&gt;","+        &lt;or&gt;","+            &lt;equals arg1=\"${os-version}\" arg2=\"linux\"/&gt;","+            &lt;equals arg1=\"${os-version}\" arg2=\"linuxamd64\"/&gt;","+        &lt;/or&gt;","+    &lt;/condition&gt;","+    &lt;antcall target=\"profiler-server-calibration-linux\"/&gt;","     &lt;copy tofile=\"${build.dir}/bin/profile-${jdk-version}.sh\" file=\"profile-${os-version}-${jdk-version}.sh\" /&gt;","   &lt;/target&gt;"," "]}]}}
